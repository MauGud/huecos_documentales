<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analizador de Secuencia Vehicular</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <!-- HEADER -->
    <header>
        <div class="header-content">
            <a href="#" class="logo">Analizador Vehicular</a>
            <nav>
                <ul class="nav-links">
                    <li><a href="#auth">Autenticación</a></li>
                    <li><a href="#search">Búsqueda</a></li>
                    <li><a href="#analysis">Análisis</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- CONTENIDO PRINCIPAL -->
    <main>
        <!-- PASO 1: AUTENTICACIÓN -->
        <section id="auth" class="form-section">
            <h2>Autenticación</h2>
            <form id="authForm">
                <div class="form-group">
                    <label for="email">Email <span class="required">*</span></label>
                    <input type="email" id="email" placeholder="tu-email@nexcar.mx" required>
                </div>
                <div class="form-group">
                    <label for="password">Contraseña <span class="required">*</span></label>
                    <input type="password" id="password" placeholder="Tu contraseña" required>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn" id="authBtn">Generar Token</button>
                    <button type="button" class="btn btn-secondary" id="clearTokenBtn">Limpiar Token</button>
                </div>
            </form>
            
            <!-- Estado del Token -->
            <div class="token-status" id="tokenStatus" style="display: none;">
                <h3>Estado del Token</h3>
                <div id="tokenInfo"></div>
            </div>
        </section>

        <!-- PASO 2: BÚSQUEDA -->
        <section id="search" class="form-section" style="display: none;">
            <h2>Consultar Expediente</h2>
            <form id="fetchForm">
                <div class="form-group">
                    <label for="url_input">URL de Nexcar o Vehicle ID <span class="required">*</span></label>
                    <input 
                        type="text" 
                        id="url_input" 
                        placeholder="https://app.nexcar.mx/workspace-analysis/a8d858eb-70e6-4aba-b940-1473211c2380/#!"
                        required>
                    <small>Pega la URL completa de Nexcar o solo el Vehicle ID (UUID)</small>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn" id="fetchBtn">Consultar Expediente</button>
                </div>
            </form>
        </section>

        <!-- DATOS EXTRAÍDOS -->
        <section id="extractedData" class="data-section" style="display: none;">
            <h2>Información del Expediente</h2>
            <div id="extractedContent"></div>
        </section>

        <!-- PASO 3: ANÁLISIS -->
        <section id="analysis" class="form-section" id="analyzeSection" style="display: none;">
            <h2>Análisis de Secuencia</h2>
            <p>Analiza la cadena de propiedad vehicular basada en los documentos encontrados.</p>
            
            <div class="form-actions">
                <button type="button" class="btn" id="analyzeBtn" style="display: none;">Analizar Secuencia</button>
            </div>
        </section>

        <!-- RESULTADOS DEL ANÁLISIS -->
        <section id="analysisResults" class="data-section" style="display: none;">
            <div id="analysisContent"></div>
        </section>

        <!-- LOADING -->
        <div id="loading" class="loading" style="display: none;">
            Procesando...
        </div>

        <!-- ERRORES -->
        <div id="error" class="error" style="display: none;"></div>
    </main>

    <script src="/app_new.js"></script>
</body>
</html>